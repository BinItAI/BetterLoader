<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<title data-react-helmet="true">Getting Started | BetterLoader</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Getting Started | BetterLoader"><meta data-react-helmet="true" name="description" content="Installation"><meta data-react-helmet="true" property="og:description" content="Installation"><meta data-react-helmet="true" property="og:url" content="https://binitai.github.io/BetterLoader/docs/"><link data-react-helmet="true" rel="shortcut icon" href="/BetterLoader/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://binitai.github.io/BetterLoader/docs/"><link rel="stylesheet" href="/BetterLoader/styles.de475da7.css">
<link rel="preload" href="/BetterLoader/styles.b1e8ed41.js" as="script">
<link rel="preload" href="/BetterLoader/runtime~main.e0e39230.js" as="script">
<link rel="preload" href="/BetterLoader/main.d07df224.js" as="script">
<link rel="preload" href="/BetterLoader/common.26ed4a81.js" as="script">
<link rel="preload" href="/BetterLoader/19.dbc7c214.js" as="script">
<link rel="preload" href="/BetterLoader/20.988c1944.js" as="script">
<link rel="preload" href="/BetterLoader/935f2afb.c8833c53.js" as="script">
<link rel="preload" href="/BetterLoader/17896441.ff5c2eb6.js" as="script">
<link rel="preload" href="/BetterLoader/da7e18d7.dcf63bcd.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/BetterLoader/"><img class="navbar__logo" src="/BetterLoader/img/logo.png" alt="My Site Logo"><strong class="navbar__title">BetterLoader</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/BetterLoader/docs/">Docs</a><a class="navbar__item navbar__link" href="/BetterLoader/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/binitai/BetterLoader" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/BetterLoader/"><img class="navbar__logo" src="/BetterLoader/img/logo.png" alt="My Site Logo"><strong class="navbar__title">BetterLoader</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/BetterLoader/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/BetterLoader/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/binitai/BetterLoader" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">BetterLoader</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/BetterLoader/docs/">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/BetterLoader/docs/files">Index &amp; Subset Files</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Getting Started</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="installation"></a>Installation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#installation" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="python"></a>Python<a aria-hidden="true" tabindex="-1" class="hash-link" href="#python" title="Direct link to heading">#</a></h3><p>The BetterLoader library is hosted on <a href="https://pypi.org/" target="_blank" rel="noopener noreferrer">pypi</a> and can be installed via <a href="https://pip.pypa.io/en/stable/" target="_blank" rel="noopener noreferrer">pip</a>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> betterloader</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="from-source"></a>From Source<a aria-hidden="true" tabindex="-1" class="hash-link" href="#from-source" title="Direct link to heading">#</a></h3><p>For developers, BetterLoader&#x27;s source may also be found at our <a href="https://github.com/BinItAI/BetterLoader" target="_blank" rel="noopener noreferrer">Github repository</a>. You can also install BetterLoader from source, but if you&#x27;re just trying to use the package, pip is probably a far better bet.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="usage"></a>Usage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#usage" title="Direct link to heading">#</a></h2><p>BetterLoader really shines when you&#x27;re working with a dataset, and you want to load subsets of image classes conditionally. Say you have 3 folders of images, and you only want to load those images that conform to a specific condition, <b>or</b> those that are present in a pre-defined subset file. What if you want to load a specific set of crops per source image, given a set of source images? BetterLoader can do all this, and more.<br></p><b>Note:</b> BetterLoader currently only supports supervised deep learning tasks. Unsupervised learning support coming soon!<h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-usage"></a>Basic Usage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-usage" title="Direct link to heading">#</a></h3><p>Using BetterLoader with its default parameters lets it function just like the regular Python dataloader. A few points worth noting are that:</p><ul><li>BetterLoader does not expect a nested folder structure. In its current iteration, files are expected to all be present in the root directory. This lets us use index files to define classes and labels dynamically, and vary them from experiment to experiment.</li><li><b>Every</b> instance of BetterLoader requires an index file to function. The default index file format maps class names to a list of image paths, but the index file can be any json file as long as you modify train_test_val_instances to parse it correctly; for example you could instead map class names to regex for the file paths and pass a train_test_val_instances that reads the files based on that regex. Sample index files may be found <a href="/BetterLoader/docs/files">here</a>.</li></ul><p>A sample use-case for BetterLoader may be found below. It&#x27;s worth noting that at this point in time, the BetterLoader class has only one callable function.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> betterloader </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> BetterLoader</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">index_json </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;./examples/sample_index.json&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># or index_object = {&quot;class1&quot;:[&quot;image0.jpg&quot;,&quot;image1.jpg&quot;,&quot;image2.jpg&quot;,&quot;image3.jpg&quot;],&quot;class2&quot;:[&quot;image4.jpg&quot;,&quot;image5.jpg&quot;,&quot;image6.jpg&quot;,&quot;image7.jpg&quot;]}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">basepath </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./examples/sample_dataset/&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">batch_size </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">loader </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> BetterLoader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">basepath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">basepath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index_json_path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">index_json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># or loader = BetterLoader(basepath=basepath, index_object=index_object)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">dataloaders</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> sizes </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> loader</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fetch_segmented_dataloaders</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">batch_size</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> transform</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Dataloader sizes: {}&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">format</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sizes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="constructor-parameters"></a>Constructor Parameters<a aria-hidden="true" tabindex="-1" class="hash-link" href="#constructor-parameters" title="Direct link to heading">#</a></h3><table><thead><tr><th>field</th><th align="center">type</th><th align="right">description</th><th align="right">optional (datatype)</th></tr></thead><tbody><tr><td>basepath</td><td align="center">str</td><td align="right">path to image directory</td><td align="right">no</td></tr><tr><td>index_json_path</td><td align="center">str</td><td align="right">path to index file</td><td align="right">yes (None)</td></tr><tr><td>index_object</td><td align="center">dict</td><td align="right">An object representation of an index file</td><td align="right">yes (None)</td></tr><tr><td>num_workers</td><td align="center">int</td><td align="right">number of workers</td><td align="right">yes (1)</td></tr><tr><td>subset_json_path</td><td align="center">str</td><td align="right">path to subset json file</td><td align="right">yes (None)</td></tr><tr><td>subset_object</td><td align="center">dict</td><td align="right">An object representation of the subset file</td><td align="right">yes (None)</td></tr><tr><td>dataset_metadata</td><td align="center">metadata object for dataset</td><td align="right">list of optional metadata attributes to customise the BetterLoader</td><td align="right">yes (None)</td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dataset-metadata"></a>Dataset Metadata<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dataset-metadata" title="Direct link to heading">#</a></h4><p>BetterLoader accepts certain key value pairs as dataset metadata, in order to enable some custom functionality.</p><ol><li>pretransform (callable, optional): This allows us to load a custom pretransform before images are loaded into the dataloader and transformed.
For basic usage a pretransform that does not do anything (the default) is usually sufficient. An example use case for the customizability is listed below.</li><li>classdata (callable, optional): Defines a custom mapping for a custom format index file to read data from the DatasetFolder class.
Since the index file may have any structure we need to ensure that the classes and a mapping from the classes to the index are always available.
Returns a tuple (list of classes, dictionary mapping of class to index)</li><li>split (tuple, optional): Defines a tuple for train, test, val values which must add to one.</li><li>train_test_val_instances (callable, optional): Defines a custom function to read values from the index file.
The default expects an index that is a dict mapping classes to a list of file paths, will need to be written custom for different index formats.
Always must return train test and val splits, which each need to be a list of tuples, each tuple corresponding to one datapoint.
The first element of this tuple must also be the filepath of the image for that datapoint.
The default also has the target class index as the second element of this tuple, this is probably good for most use cases.
Each of these datapoint tuples is passed as the <code>values</code> argument in the pretransform, any additional data necessary for transforming the datapoint before it is loaded can go in the datapoint tuple.</li><li>supervised (bool, optional): Defines whether or not the experiment is supervised</li><li>custom_collator (callable, optional): Custom function that merges a list of samples to form a mini-batch of Tensors</li><li>drop_last (bool, optional): Defines whether to drop the last incomplete batch if the dataset is not divisible by batch size to avoid sizing errors</li><li>pin_mem (bool, optional): Sets the data load to copy tensors into CUDA pinned memory before returning them, providing your data elements are not custom type</li><li>sampler (torch.utils.data.Sampler or <code>iterable</code>, optional): Can be used to define a custom strategy to draw data from the dataset</li></ol><hr><p>Here is an example of a <code>pretransform</code> and a <code>train_test_val_instances</code> designed to allow for a specified crop to be taken of each image.</p><b>Notes</b>:<ul><li>The internals of the loader dictate that the elements of the <code>instances</code> variables generated from train_test_val_instances will become the <code>values</code> argument for a pretransform call, and the <code>sample</code> argument for pretransform is the image data loaded directly from the filepath in <code>values[0]</code> (or <code>instances[i][0]</code>).</li><li>Since the index file here has a similar structure to the default we can get away with using the default classdata function, but index files that don&#x27;t have the classes as keys of a dictionary will need a custom way of determining the classes.</li></ul><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">pretransform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sample</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;Example pretransform - takes an image and crops it based on the parameters defined in values</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Args:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        values (tuple): Tuple of values relevant to a given image - created by the train_test_val_instances function</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Returns:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        tuple: Actual modified image, and the target class index for that image</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    &quot;&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> crop_params </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> values</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># pretransform should always return a tuple of this structure (some image data, some target class index)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_crop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sample</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> crop_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-python codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">train_test_val_instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> class_to_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> is_valid_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;Function to perform default train/test/val instance creation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Args:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        split (tuple): Tuple of ratios (from 0 to 1) for train, test, val values</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        directory (str): Parent directory to read images from</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        class_to_idx (dict): Dictionary to map values from class strings to index values</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        index (dict): Index file dict object</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        is_valid_file (callable): Function to verify if a file should be loaded</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Returns:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">        (tuple): Tuple of length 3 containing train, test, val instances</span></div><div class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    &quot;&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> target_class </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">sorted</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">class_to_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">keys</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        i </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">isdir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">continue</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        instances </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> filename </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">target_class</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> is_valid_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                path </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">directory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> filename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> class_to_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">target_class</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        trainp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> valp </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> split</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        train </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">trainp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        test </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">trainp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">valp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        val </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">instances</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">valp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> val</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/binitai/BetterLoader/docs/gettingstarted.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/BetterLoader/docs/files"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Index &amp; Subset Files Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation" class="table-of-contents__link">Installation</a><ul><li><a href="#python" class="table-of-contents__link">Python</a></li><li><a href="#from-source" class="table-of-contents__link">From Source</a></li></ul></li><li><a href="#usage" class="table-of-contents__link">Usage</a><ul><li><a href="#basic-usage" class="table-of-contents__link">Basic Usage</a></li><li><a href="#constructor-parameters" class="table-of-contents__link">Constructor Parameters</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/BetterLoader/docs/">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/BetterLoader" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discord.gg/T4Hxcq6" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 BinIt, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/BetterLoader/styles.b1e8ed41.js"></script>
<script src="/BetterLoader/runtime~main.e0e39230.js"></script>
<script src="/BetterLoader/main.d07df224.js"></script>
<script src="/BetterLoader/common.26ed4a81.js"></script>
<script src="/BetterLoader/19.dbc7c214.js"></script>
<script src="/BetterLoader/20.988c1944.js"></script>
<script src="/BetterLoader/935f2afb.c8833c53.js"></script>
<script src="/BetterLoader/17896441.ff5c2eb6.js"></script>
<script src="/BetterLoader/da7e18d7.dcf63bcd.js"></script>
</body>
</html>